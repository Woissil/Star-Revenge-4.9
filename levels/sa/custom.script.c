#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"
#include "game/level_update.h"
#include "levels/scripts.h"
#include "actors/common1.h"
#include "make_const_nonconst.h"

#include "areas/1/custom.model.inc.h"

#include "levels/sa/header.h"
#include "levels/rr/header.h"

extern u8 _sa_segment_ESegmentRomStart[];
extern u8 _sa_segment_ESegmentRomEnd[];

const LevelScript level_sa_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _rr_segment_7SegmentRomStart, _rr_segment_7SegmentRomEnd),
	LOAD_RAW(0x1A, _rrSegmentRomStart, _rrSegmentRomEnd),
	LOAD_RAW(0x0E, _sa_segment_ESegmentRomStart, _sa_segment_ESegmentRomEnd),
	LOAD_MIO0(        /*seg*/ 0x0B, _effect_mio0SegmentRomStart, _effect_mio0SegmentRomEnd),
	LOAD_MIO0(0xA, _SkyboxCustom36863216_skybox_mio0SegmentRomStart, _SkyboxCustom36863216_skybox_mio0SegmentRomEnd),
	LOAD_MIO0(8, _common0_mio0SegmentRomStart, _common0_mio0SegmentRomEnd),
	LOAD_RAW(15, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd),
	LOAD_MIO0(5, _group1_mio0SegmentRomStart, _group1_mio0SegmentRomEnd),
	LOAD_RAW(12, _group1_geoSegmentRomStart, _group1_geoSegmentRomEnd),
	LOAD_MIO0(6, _group17_mio0SegmentRomStart, _group17_mio0SegmentRomEnd),
	LOAD_RAW(13, _group17_geoSegmentRomStart, _group17_geoSegmentRomEnd),
	ALLOC_LEVEL_POOL(),
	MARIO(/*model*/ MODEL_MARIO, /*behParam*/ 0x00000001, /*beh*/ bhvMario),
	// Level Specific Models

	// Unspecified Models
	LOAD_MODEL_FROM_GEO(22,  warp_pipe_geo),
	LOAD_MODEL_FROM_GEO(23,  bubbly_tree_geo),
	LOAD_MODEL_FROM_GEO(24,  spiky_tree_geo),
	LOAD_MODEL_FROM_GEO(25,  snow_tree_geo),
	LOAD_MODEL_FROM_GEO(27,  palm_tree_geo),
	LOAD_MODEL_FROM_GEO(31,  metal_door_geo),
	LOAD_MODEL_FROM_GEO(32,  hazy_maze_door_geo),
	LOAD_MODEL_FROM_GEO(34,  castle_door_0_star_geo),
	LOAD_MODEL_FROM_GEO(35,  castle_door_1_star_geo),
	LOAD_MODEL_FROM_GEO(36,  castle_door_3_stars_geo),
	LOAD_MODEL_FROM_GEO(37,  key_door_geo),
	LOAD_MODEL_FROM_GEO(38,  castle_door_geo),
	LOAD_MODEL_FROM_GEO(15,  brodute_geo),
	// LOAD_MODEL_FROM_GEO(131, 0x0404fe00),
	// LOAD_MODEL_FROM_DL(132, 0x08025f08, 4),
	// LOAD_MODEL_FROM_GEO(137, 0x04050000),
	// LOAD_MODEL_FROM_DL(158, 0x0302c8a0, 4),
	// LOAD_MODEL_FROM_DL(159, 0x0302bcd0, 4),
	// LOAD_MODEL_FROM_DL(161, 0x0301cb00, 4),
	// LOAD_MODEL_FROM_DL(164, 0x04032a18, 4),
	// LOAD_MODEL_FROM_DL(201, 0x080048e0, 4),
	// LOAD_MODEL_FROM_DL(218, 0x08024bb8, 4),
	JUMP_LINK(script_func_global_1),
	JUMP_LINK(script_func_global_2),
	JUMP_LINK(script_func_global_18),
	JUMP_LINK(local_area_sa_1_),
	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(/*arg*/ 0, /*func*/ lvl_init_or_update),
	CALL_LOOP(/*arg*/ 1, /*func*/ lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(/*frames*/ 1),
	EXIT(),
};

const LevelScript local_area_sa_1_[] = {
	AREA(1, Geo_sa_1_0x234dc10),
	TERRAIN(col_sa_1_0xe0a8b70),
	SET_BACKGROUND_MUSIC(0, 67),
	TERRAIN_TYPE(0),
	JUMP_LINK(local_objects_sa_1_),
	JUMP_LINK(local_warps_sa_1_),
	END_AREA(),
	RETURN()
};

const LevelScript local_objects_sa_1_[] = {
	OBJECT_WITH_ACTS(0, 751, 1393, 1950, 0, 180, 0, 0xa0000,  bhvSpinAirborneWarp, 31),
	OBJECT_WITH_ACTS(122, -12441, 2575, 1685, 0, 1, 0, 0x0,  bhvStar, 31),
	OBJECT_WITH_ACTS(123, -3307, 6836, -1462, 0, 1, 0, 0x640000,  bhvNoteblock_MOP, 31),
	OBJECT_WITH_ACTS(153, -3356, 8536, -247, 0, 2, 0, 0x0,  bhvSandBlock_MOP, 31),
	OBJECT_WITH_ACTS(153, -3347, 8278, 116, 0, 2, 0, 0x0,  bhvSandBlock_MOP, 31),
	OBJECT_WITH_ACTS(153, -3305, 8062, 663, 0, 2, 0, 0x0,  bhvSandBlock_MOP, 31),
	OBJECT_WITH_ACTS(153, -2886, 8062, 1734, 0, 2, 0, 0x0,  bhvSandBlock_MOP, 31),
	OBJECT_WITH_ACTS(153, -2160, 8350, 2489, 0, 2, 0, 0x0,  bhvSandBlock_MOP, 31),
	OBJECT_WITH_ACTS(153, -1398, 8650, 3351, 0, 2, 0, 0x0,  bhvSandBlock_MOP, 31),
	OBJECT_WITH_ACTS(122, 7500, 7024, -21277, 0, 2, 0, 0x0,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, 4656, 5191, -21277, 0, 91, 0, 0xac860000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, 4656, 6730, -14012, 0, 181, 0, 0x38c80000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(201, 3002, 750, -2244, 0, 0, 0, 0x0,  bhvCannonClosed, 31),
	OBJECT_WITH_ACTS(137, -1479, 5670, -3547, 0, 0, 0, 0x20000,  bhvExclamationBox, 31),
	OBJECT_WITH_ACTS(122, 9572, 7988, -12916, 0, 0, 0, 0x1000000,  bhvStar, 31),
	OBJECT_WITH_ACTS(0, 1537, 5945, -13873, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 7500, 7554, -21277, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 4656, 5532, -21277, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(122, 9558, 3372, -10832, 0, 179, 0, 0x32000000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, 9558, 2946, -9592, 0, 179, 0, 0x32000000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, -917, 12156, -477, 0, 180, 0, 0x2000000,  bhvStar, 31),
	OBJECT_WITH_ACTS(122, 1085, 14664, -4208, 0, 180, 0, 0x3000000,  bhvStar, 31),
	OBJECT_WITH_ACTS(122, 9558, 2160, -6818, 0, 180, 0, 0x32000000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, 9558, 1650, -5729, 0, 180, 0, 0x32000000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, 9558, 1020, -4470, 0, 180, 0, 0x32000000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, -13241, 1719, 882, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, -11793, 1719, 1108, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, -13298, 519, -538, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, -11636, 519, -563, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 549, 8651, 4040, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 1062, 4913, 4535, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 2333, 4913, 4151, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 2330, 4913, 4914, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, -3375, 720, -4995, 0, 0, 0, 0x0,  bhvCirclingAmp, 31),
	OBJECT_WITH_ACTS(122, -2388, 11820, 371, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, -3319, 10110, -5162, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, -391, 7770, -12909, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, 7918, 3930, -12917, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, 3597, 1080, -2289, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, 540, 810, -257, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(0, -3986, 13472, -1182, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 608, 11504, -1794, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(122, 693, 9710, -5266, 0, 0, 0, 0x0,  bhvChuckya, 31),
	OBJECT_WITH_ACTS(122, -2612, 9250, -3209, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, -3290, 7779, -3484, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, 589, 6711, -3753, 0, 0, 0, 0x0,  bhvCirclingAmp, 31),
	OBJECT_WITH_ACTS(122, 8116, 3627, 4317, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, 9603, 2493, 1982, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, 9603, 1281, 266, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, 302, 1803, -1671, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, -1362, 999, -4969, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, -12485, 489, -1347, 0, 0, 0, 0x0,  bhvFireSpitter, 31),
	OBJECT_WITH_ACTS(122, -12468, 969, 934, 0, 0, 0, 0x0,  bhvChuckya, 31),
	OBJECT_WITH_ACTS(122, -1003, 12555, -4303, 0, 0, 0, 0x0,  bhvChuckya, 31),
	OBJECT_WITH_ACTS(122, -2635, 12555, -4177, 0, 0, 0, 0x0,  bhvChuckya, 31),
	OBJECT_WITH_ACTS(122, -924, 11113, -1730, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, -2447, 11113, -1699, 0, 0, 0, 0x0,  bhvSnufit, 31),
	OBJECT_WITH_ACTS(122, 615, 6686, -5087, 0, 0, 0, 0x0,  bhvChuckya, 31),
	OBJECT_WITH_ACTS(122, 380, 9450, -306, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 604, 7013, 681, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(0, 605, 8053, 1981, 0, 0, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 435, 1579, -271, 0, 90, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(122, 9537, 511, -3474, 0, 90, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 9560, 511, -1060, 0, 90, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(122, 5703, 4905, -12913, 0, 90, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(0, 4606, 5796, -12919, 0, 90, 0, 0x100000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, -3150, 2196, -1652, 0, 90, 0, 0x110000,  bhvFadingWarp, 31),
	OBJECT_WITH_ACTS(0, -1654, 5430, -3297, 0, 90, 0, 0x100000,  bhvFadingWarp, 31),
	OBJECT_WITH_ACTS(0, -1772, 5255, -4674, 0, 90, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 7508, 1439, -2239, 0, 90, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 2148, 329, -462, 0, 90, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 3002, 700, -1191, 0, 0, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, 6016, 4073, 4564, 0, 269, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(122, -1419, 7542, -5106, 0, 0, 0, 0x0,  bhvCirclingAmp, 31),
	OBJECT_WITH_ACTS(122, 3518, 5328, 4865, 0, 0, 0, 0x0,  bhvCirclingAmp, 31),
	OBJECT_WITH_ACTS(122, 4052, 5022, 4246, 0, 0, 0, 0x0,  bhvCirclingAmp, 31),
	OBJECT_WITH_ACTS(122, 4815, 4566, 4851, 0, 0, 0, 0x0,  bhvCirclingAmp, 31),
	OBJECT_WITH_ACTS(0, -11556, 2999, -7933, 0, 329, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, -10598, 3605, -9576, 0, 329, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, -2267, 7034, -13045, 0, 269, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, -3933, 6392, -12822, 0, 269, 0, 0x0,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(0, -394, 12156, -447, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(207, -3692, 1812, -1645, 0, 90, 0, 0x0,  bhvFloorSwitchHiddenObjects, 31),
	OBJECT_WITH_ACTS(129, -651, 2652, -3801, 0, 0, 0, 0x0,  bhvHiddenObject, 31),
	OBJECT_WITH_ACTS(129, -489, 1968, -3579, 0, 0, 0, 0x0,  bhvHiddenObject, 31),
	OBJECT_WITH_ACTS(129, -1394, 1602, -2502, 0, 0, 0, 0x0,  bhvHiddenObject, 31),
	OBJECT_WITH_ACTS(124, -3978, 12555, -2995, 0, 0, 0, 0x8c0000,  bhvMessagePanel, 31),
	OBJECT_WITH_ACTS(124, -12449, 969, 1291, 0, 180, 0, 0x7a0000,  bhvMessagePanel, 31),
	OBJECT_WITH_ACTS(152, -10735, 600, 506, 0, 45, 0, 0x6e000000,  bhvShrink_Platform_MOP, 31),
	OBJECT_WITH_ACTS(152, -10735, 967, 506, 0, 45, 0, 0x6e000000,  bhvShrink_Platform_MOP, 31),
	OBJECT_WITH_ACTS(152, -10735, 1324, 506, 0, 45, 0, 0x6e000000,  bhvShrink_Platform_MOP, 31),
	OBJECT_WITH_ACTS(124, 201, 11892, -2068, 0, 128, 0, 0x4f0000,  bhvMessagePanel, 31),
	OBJECT_WITH_ACTS(15, 299, 750, 1583, 0, 0, 0, 0x2d0000,  bhvBobombBuddy, 31),
	OBJECT_WITH_ACTS(122, 9558, 2725, -12310, 0, 0, 0, 0x2e1e0000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(146, 7500, 6054, -18471, 0, 0, 0, 0x93460000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(122, 7500, 7284, -16320, 0, 90, 0, 0x705c0000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(0, 7500, 7702, -16320, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(122, 9556, 8058, -16320, 0, 0, 0, 0x14880000,  bhvSpring_MOP, 31),
	OBJECT_WITH_ACTS(0, 9556, 8476, -16320, 0, 0, 0, 0x110000,  bhvCoinFormation, 31),
	OBJECT_WITH_ACTS(46, 5107, 7305, -12908, 0, 90, 0, 0x0,  bhvCheckpoint_Flag_MOP, 31),
	OBJECT_WITH_ACTS(46, 662, 7244, -12921, 0, 0, 0, 0x10000,  bhvCheckpoint_Flag_MOP, 31),
	OBJECT_WITH_ACTS(46, 9567, 7969, -12915, 0, 0, 0, 0x10000,  bhvCheckpoint_Flag_MOP, 31),
	OBJECT_WITH_ACTS(122, 7506, 6698, -19576, 0, 0, 0, 0x0,  bhvGoomba, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 102, 0, 0, 20, 168,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, -10, 4, 5, 0, 0, 20, 169,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 30, 0, 0, 20, 170,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 4, 0, 0, 20, 171,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 402, 0, 0, 20, 172,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 2171, 0, 0, 20, 173,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 1446, 0, 0, 20, 174,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 2168, 0, 0, 20, 175,  RM_Scroll_Texture, 31),
	OBJECT_WITH_ACTS(0, 18, 5, 724, 0, 0, 20, 176,  RM_Scroll_Texture, 31),
	RETURN()
};

const LevelScript local_warps_sa_1_[] = {
	WARP_NODE(10, 9, 1, 0, 0),
	WARP_NODE(16, 20, 1, 17, 0),
	WARP_NODE(17, 20, 1, 16, 0),
	WARP_NODE(240, 16, 1, 18, 0),
	WARP_NODE(241, 16, 1, 19, 0),
	RETURN()
};
